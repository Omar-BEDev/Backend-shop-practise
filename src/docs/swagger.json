{
  "openapi": "3.0.0",
  "info": {
    "title": "Backend Shop API",
    "description": "A professional E-commerce REST API built with Express, TypeScript, and MongoDB.",
    "version": "1.0.0",
    "contact": {
      "name": "API Support"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "nickname": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "password": { "type": "string", "minLength": 8 },
          "birthDate": { "type": "string", "format": "date", "example": "1995-01-01" },
          "address": {
            "type": "object",
            "properties": {
              "country": { "type": "string" },
              "city": { "type": "string" }
            }
          }
        }
      },
      "Product": {
        "type": "object",
        "required": ["name", "description", "price", "stock", "category"],
        "properties": {
          "name": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "stock": { "type": "number" },
          "images": { "type": "array", "items": { "type": "string" } },
          "category": { "type": "string" },
          "isActive": { "type": "boolean" },
          "sku": { "type": "string", "readOnly": true }
        }
      },
      "Order": {
        "type": "object",
        "required": ["userId", "items", "totalPrice"],
        "properties": {
          "userId": { "type": "string", "description": "MongoDB ObjectId" },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "productId": { "type": "string" },
                "name": { "type": "string" },
                "quantity": { "type": "number" },
                "price": { "type": "number" }
              }
            }
          },
          "totalPrice": { "type": "number" },
          "discountValue": { "type": "number" },
          "status": { "type": "string", "enum": ["pending", "completed", "cancelled"] }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "success": { "type": "boolean", "example": false },
          "message": { "type": "string" }
        }
      }
    }
  },
  "tags": [
    { "name": "Users", "description": "Authentication and User Management" },
    { "name": "Products", "description": "Product Inventory Management" },
    { "name": "Orders", "description": "Customer Orders and Statistics" }
  ],
  "paths": {
    "/api/users/signup": {
      "post": {
        "tags": ["Users"],
        "summary": "Register a new user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/User" } }
          }
        },
        "responses": {
          "200": { "description": "User created successfully" },
          "400": { "description": "Validation error" }
        }
      }
    },
    "/api/users/login": {
      "post": {
        "tags": ["Users"],
        "summary": "Login user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Login successful" },
          "404": { "description": "User not found" }
        }
      }
    },
    "/api/users/banned": {
      "put": {
        "tags": ["Users"],
        "summary": "Ban a user (Admin only)",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "User banned" },
          "403": { "description": "Forbidden" }
        }
      }
    },
    "/api/products": {
      "get": {
        "tags": ["Products"],
        "summary": "Get all products",
        "parameters": [
          { "name": "category", "in": "query", "schema": { "type": "string" } },
          { "name": "price", "in": "query", "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "List of products" }
        }
      }
    },
    "/api/products/add": {
      "post": {
        "tags": ["Products"],
        "summary": "Add a new product (Admin only)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/Product" } }
          }
        },
        "responses": {
          "201": { "description": "Product created" }
        }
      }
    },
    "/api/products/update/{id}": {
      "put": {
        "tags": ["Products"],
        "summary": "Update product (Admin only)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/Product" } }
          }
        },
        "responses": {
          "200": { "description": "Product updated" }
        }
      }
    },
    "/api/products/delete/{id}": {
      "delete": {
        "tags": ["Products"],
        "summary": "Delete product (Admin only)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Product deleted" }
        }
      }
    },
    "/api/orders": {
      "get": {
        "tags": ["Orders"],
        "summary": "Get logged in user orders",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "List of user orders" }
        }
      }
    },
    "/api/orders/add": {
      "post": {
        "tags": ["Orders"],
        "summary": "Create a new order",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/Order" } }
          }
        },
        "responses": {
          "201": { "description": "Order created" }
        }
      }
    },
    "/api/orders/update/{id}/{productId}": {
      "put": {
        "tags": ["Orders"],
        "summary": "Update item quantity in a pending order",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" }, "description": "Order ID" },
          { "name": "productId", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "quantity": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Order updated" }
        }
      }
    },
    "/api/orders/cancel/{id}": {
      "put": {
        "tags": ["Orders"],
        "summary": "Cancel an order",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Order cancelled" }
        }
      }
    },
    "/api/orders/statistics": {
      "get": {
        "tags": ["Orders"],
        "summary": "Get order statistics (Admin only)",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Dashboard data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "orders": { "type": "array", "items": { "$ref": "#/components/schemas/Order" } },
                    "numOfOrders": { "type": "number" },
                    "completedOrders": { "type": "number" }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
